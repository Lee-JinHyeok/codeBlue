<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	
	<title>공지 관리 - 코드블루</title>
	
	<!-- Custom fonts for this template-->
	<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
	
	<!-- Custom styles for this template-->
	<link href="css/sb-admin-2.min.css" rel="stylesheet">
	<!-- Custom styles for codeBlue -->
	<link href="css/codeBlue.css" rel="stylesheet"> 
</head>

<body id="page-top"> 
  <!-- Page Wrapper -->
  <div id="wrapper">

	 <!-- Side Bar load -->
 	<div id="sideBar"></div>
    
    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

      <!-- Main Content -->
      <div id="content">

        <!-- Topbar -->
        <nav class="navbar navbar-expand navbar-light topbar shadow" style="height: 60px;border-bottom: 1px solid #d9d9d9; border-top: 4px solid #4e73df;">
			
          <!-- Sidebar Toggle (Topbar) -->
          <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
            <i class="fa fa-bars"></i>
          </button>

          <!-- Topbar Search -->
          <form class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
            <div class="input-group">
              <input type="text" class="form-control bg-light border-1 small" placeholder="항목 검색" aria-label="Search" aria-describedby="basic-addon2">
              <div class="input-group-append">
                <button class="btn btn-primary" type="button">
                  <i class="fas fa-search fa-sm"></i>
                </button>
              </div>
            </div>
          </form>

          <!-- Topbar Navbar -->
          <ul class="navbar-nav ml-auto">

            <!-- Nav Item - Search Dropdown (Visible Only XS) -->
            <li class="nav-item dropdown no-arrow d-sm-none">
              <a class="nav-link dropdown-toggle" href="#" id="searchDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fas fa-search fa-fw"></i>
              </a>
              <!-- Dropdown - Messages -->
              <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in" aria-labelledby="searchDropdown">
                <form class="form-inline mr-auto w-100 navbar-search">
                  <div class="input-group">
                    <input type="text" class="form-control bg-light border-0 small" placeholder="Search for..." aria-label="Search" aria-describedby="basic-addon2">
                    <div class="input-group-append">
                      <button class="btn btn-primary" type="button">
                        <i class="fas fa-search fa-sm"></i>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </li>

            <!-- Nav Item - Alerts -->
            <li class="nav-item dropdown no-arrow mx-1">
              <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fas fa-bell fa-fw"></i>
                <!-- Counter - Alerts -->
                <span class="badge badge-danger badge-counter">3+</span>
              </a>
              <!-- Dropdown - Alerts -->
              <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="alertsDropdown">
                <h6 class="dropdown-header">
                  Alerts Center
                </h6>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="mr-3">
                    <div class="icon-circle bg-primary">
                      <i class="fas fa-file-alt text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">December 12, 2019</div>
                    <span class="font-weight-bold">A new monthly report is ready to download!</span>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="mr-3">
                    <div class="icon-circle bg-success">
                      <i class="fas fa-donate text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">December 7, 2019</div>
                    $290.29 has been deposited into your account!
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="mr-3">
                    <div class="icon-circle bg-warning">
                      <i class="fas fa-exclamation-triangle text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">December 2, 2019</div>
                    Spending Alert: We've noticed unusually high spending for your account.
                  </div>
                </a>
                <a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
              </div>
            </li>

            <!-- Nav Item - Messages -->
            <li class="nav-item dropdown no-arrow mx-1">
              <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fas fa-envelope fa-fw"></i>
                <!-- Counter - Messages -->
                <span class="badge badge-danger badge-counter">7</span>
              </a>
              <!-- Dropdown - Messages -->
              <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="messagesDropdown">
                <h6 class="dropdown-header">
                  Message Center
                </h6>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img class="rounded-circle" src="https://source.unsplash.com/fn_BT9fwg_E/60x60" alt="">
                    <div class="status-indicator bg-success"></div>
                  </div>
                  <div class="font-weight-bold">
                    <div class="text-truncate">Hi there! I am wondering if you can help me with a problem I've been having.</div>
                    <div class="small text-gray-500">Emily Fowler · 58m</div>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img class="rounded-circle" src="https://source.unsplash.com/AU4VPcFN4LE/60x60" alt="">
                    <div class="status-indicator"></div>
                  </div>
                  <div>
                    <div class="text-truncate">I have the photos that you ordered last month, how would you like them sent to you?</div>
                    <div class="small text-gray-500">Jae Chun · 1d</div>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img class="rounded-circle" src="https://source.unsplash.com/CS2uCrpNzJY/60x60" alt="">
                    <div class="status-indicator bg-warning"></div>
                  </div>
                  <div>
                    <div class="text-truncate">Last month's report looks great, I am very happy with the progress so far, keep up the good work!</div>
                    <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img class="rounded-circle" src="https://source.unsplash.com/Mv9hjnEUHR4/60x60" alt="">
                    <div class="status-indicator bg-success"></div>
                  </div>
                  <div>
                    <div class="text-truncate">Am I a good boy? The reason I ask is because someone told me that people say this to all dogs, even if they aren't good...</div>
                    <div class="small text-gray-500">Chicken the Dog · 2w</div>
                  </div>
                </a>
                <a class="dropdown-item text-center small text-gray-500" href="#">Read More Messages</a>
              </div>
            </li>

            <div class="topbar-divider d-none d-sm-block"></div>

            <!-- Nav Item - User Information -->
            <li class="nav-item dropdown no-arrow">
              <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="mr-2 d-none d-lg-inline text-gray-600 small">Valerie Luna</span>
                <img class="img-profile rounded-circle" src="https://source.unsplash.com/QAB-WJcbgJk/60x60">
              </a>
              <!-- Dropdown - User Information -->
              <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="userDropdown">
                <a class="dropdown-item" href="#">
                  <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                  Profile
                </a>
                <a class="dropdown-item" href="#">
                  <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                  Settings
                </a>
                <a class="dropdown-item" href="#">
                  <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                  Activity Log
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                  <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                  Logout
                </a>
              </div>
            </li>

          </ul>

        </nav>
        <!-- End of Topbar -->

        <!-- Begin Page Content -->
        
       	<div class="container-fluid px-4 pt-4">
		<div class="card border-0 bg-white p-3 m-2 shadow"> 
				
		<!-- Begin Page Content -->
       <div class="container-fluid px-4 pt-4">
 
         
            <!-- Page Content -->
            <div class="p-2">
            
               <!-- Page Heading -->
               <div class="d-sm-flex align-items-center justify-content-between mb-3" >
                  <h3 class="text-gray-800 mb-2 font-weight-bold">유저관리</h3>
               </div>
               
               <!-- page Heading End -->
               
        		<!-- user search -->
        	
                <div class="inline">
					<span>유저이름 : <input class="form-control form-control-sm" type="text" id="searchContent"></span>
				</div>
				
				
				<div>
					<span>회원가입일 :</span>
					<input class="form-control form-control-sm" type="date" id=toDate> <span>~</span> <input class="form-control form-control-sm" type="date" id="fromDate">
					<button type="button" class="btn btn-primary" id="searchBtn">검색</button>
					<button type="button" class="btn btn-primary" id="resetBtn">첫페이지</button>
				</div>
				
				
				
				<!-- user list -->
				<div>
					<span id="totalRow"></span>
					<span><button class="btn btn-primary" id="userRemoveBtn">강제탈퇴</button></span>
				</div>
				<select class="form-control form-control-sm" id="rowPerPage">
					<option value="10" selected="selected">10개 보기</option>
					<option value="20">20개 보기</option>
					<option value="30">30개 보기</option>
					<option value="40">40개 보기</option>
					<option value="50">50개 보기</option>
				</select>
				<table class="table table-hover" id="userList">
					<thead>
						<tr>
							<th><div class='custom-control custom-checkbox'>
								<input class='custom-control-input' type='checkbox' onclick="checkAll()" id='selectAll'><label class='custom-control-label' for='selectAll'></label>
							</div></th>
							<th>유저이름</th>
							<th>등급</th>
							<th>Region</th>
							<th>birthdate</th>
							<th>createtime</th>
							<th>Authority</th>
						</tr>
					</thead>
					<tbody id="userListContent">
					</tbody>
				</table>
				
				<button type="button" id="prevBtn" class="btn btn-primary">이전</button>
				<span id="pageInfo"></span>
				<button type="button" id="nextBtn" class="btn btn-primary">다음</button>
               
            </div>
         <!--  Page Content End -->
  
      </div> 
      
      <!-- End of Main Content -->
	</div>
      <!-- Footer -->
      <footer class="sticky-footer">
        <div class="container my-auto">
          <div class="copyright text-center my-auto">
            <img src="./img/codeBlueLogo.png" width="150px">
          </div>
        </div>
      </footer>
      <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

  </div>
  <!-- End of Page Wrapper -->

<!-- ETC -->
  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded bg-primary" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>

  <!-- Logout Modal-->
  <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">로그아웃 하시겠습니까?</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">로그아웃 하고 싶으시면 아래 로그아웃 버튼을 클릭해주세요!</div>
        <div class="modal-footer">	
          <button class="btn btn-secondary" type="button" data-dismiss="modal">취소</button>
          <a class="btn btn-primary" href="/logout">로그아웃</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap core JavaScript-->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Core plugin JavaScript-->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom scripts for all pages-->
  <script src="js/sb-admin-2.min.js"></script>

  <!-- Page level plugins -->
  <script src="vendor/chart.js/Chart.min.js"></script>

</body>
<script>
	//작성날짜 끝 자동적으로 입력하게하기
	document.getElementById("fromDate").valueAsDate = new Date();
	$("#sideBar").load("/sideBar #accordionSidebar", function(){
		$("#sideBarUser").addClass("active");
		$("#sideBarUser").children("a").attr("aria-expanded","false");
		$("#sideBarUser").children("div").addClass("show");
	});
	// 초기화 버튼 (fromDate 빼고 리셋 시킨다)
	$("#resetBtn").click(function() {
		location.reload();
	});
	var checkBoxArr = [];
	// 삭제 버튼 클릭
	$("#userRemoveBtn").click(function(){
		console.log("선택된 값을 삭제합니다.")
		$("input[name=chk]:checked").each(function(){
			checkBoxArr.push($(this).val());
		});
		console.log(checkBoxArr);
		$.ajax({
			url : "/rest/adminUserRemove",
			method : "post",
			traditional : true, //ajax에서 기본적으로 배열을 지원하지않기때문에 설정
			data : {"checkBoxArr" : checkBoxArr,},
			success : function(json){
				alert("탈퇴가 완료되었습니다.");
				location.reload();
			}
		});
	});
	// -------------------------------------------------------------------테이블 관련  시작----------------------------------------------
	// 페이징
	var currentPage = 1;
	var lastPage = 0;
	var rowPerPage = 10;
	var searchWord = null;
	var toDate = null;
	var fromDate = null;

	// 기본 홈
	$.ajax({
		url : "/rest/adminUserList",
		method : "post",
		data : {"currentPage" : currentPage},
		success : function(json){
			console.log(json);
			subInfo(json);
			BtnShow(currentPage,lastPage);
			$(json.list).each(function(index,item){
				activeView(index, item);
			});
			
		} 
	});	
	// 검색 버튼 클릭
	$("#searchBtn").click(function(){
		$("#userListContent").empty();
		$.ajax({
			url : "/rest/adminUserList",
			method : "post",
			data : {"searchWord" : $("#searchContent").val(),
					"toDate" : $("#toDate").val(),
					"fromDate" : $("#fromDate").val(),
					"rowPerPage" : $("#rowPerPage").val()},
			success : function(json){
				console.log(json);
				subInfo(json);
				BtnShow(currentPage,lastPage);
				$(json.list).each(function(index,item){
					activeView(index, item);
				});
			} 
		});
	});
	// 다음 버튼 클릭
	$("#nextBtn").click(function(){
 		$("#userListContent").empty();
		$.ajax({
			url : "/rest/adminUserList",
			method : "post",
			data : {"currentPage" : currentPage+1,
					"searchWord" : $("#searchContent").val(),
					"toDate" : $("#toDate").val(),
					"fromDate" : $("#fromDate").val(),
					"rowPerPage" : $("#rowPerPage").val()},
			success : function(json){
				console.log(json);
				subInfo(json);
				BtnShow(currentPage,lastPage);
				$(json.list).each(function(index,item){
					activeView(index, item);
				});
			} 
		});
	});
	
	// 이전 버튼 클릭
	$("#prevBtn").click(function(){
		$("#userListContent").empty();
		$.ajax({
			url : "/rest/adminUserList",
			method : "post",
			data : {"currentPage" : currentPage-1,
					"searchWord" : $("#searchContent").val(),
					"toDate" : $("#toDate").val(),
					"fromDate" : $("#fromDate").val(),
					"rowPerPage" : $("#rowPerPage").val()},
			success : function(json){
				console.log(json);
				subInfo(json);
				BtnShow(currentPage,lastPage);
				$(json.list).each(function(index,item){
					activeView(index, item);
				});
			} 
		});
	});
	// 보기형식 선택
	$("#rowPerPage").change(function(){
		$("#userListContent").empty();
		$.ajax({
			url : "/rest/adminUserList",
			method : "post",
			data : {"currentPage" : currentPage,
					"searchWord" : $("#searchContent").val(),
					"toDate" : $("#toDate").val(),
					"fromDate" : $("#fromDate").val(),
					"rowPerPage" : $("#rowPerPage").val()},
			success : function(json){
				console.log(json);
				subInfo(json);
				BtnShow(currentPage,lastPage);
				$(json.list).each(function(index,item){
					activeView(index, item);
				});
			} 
		});
	});
	
	// ajax html뛰우는 함수
	function activeView(index, item) {
		var html = "<tr>";
		html += "<td><div class='custom-control custom-checkbox'><input class='custom-control-input' type='checkbox' name='chk' id='check"+index+"' value='"+item.userId+"'><label name='chk' class='custom-control-label' for='check"+index+"'></label></div></td>";
		html += "<td>"+item.userName+"</td>";
		html += "<td>"+item.rank.rankName+"</td>";
		html += "<td>"+item.region.regionName+"</td>";
		html += "<td>"+item.userBirthdate+"</td>";
		html += "<td>"+item.userCreatetime+"</td>";
		html += "<td>"+item.userAuthority+"</td>";
		html += "</tr>";
		$("#userListContent").append(html);
	}
	// 화면뛰울때 필요한 함수(현재,마지막 페이지 등)
	function subInfo(json){
		$("#totalRow").empty();
		$("#pageInfo").empty();
		currentPage = json.currentPage;
		rowPerPage = json.rowPerPage;
		lastPage = json.lastPage;
		$("#totalRow").append("검색결과"+json.totalRow+"건");
		$("#pageInfo").append(currentPage+"/"+lastPage);
	}
	// 전체선택 함수
	function checkAll() {
		if ($("#selectAll").prop("checked") === true) {
			alert("체크");
			$("input[name=chk]").prop("checked", true);
		} else {
			alert("해제");
			$("input[name=chk]").prop("checked", false);
		}
	} 
	
	// 이전,다음버튼 함수
	function BtnShow(currentPage,lastPage) {
		if(currentPage == 1){
			$("#prevBtn").hide();
		} else {
			$("#prevBtn").show();
		}
		if(currentPage <lastPage) {
			$("#nextBtn").show();
		} else {
			$("#nextBtn").hide();
		}
	}
	// -------------------------------------------------------------------테이블 관련  끝----------------------------------------------
	
</script>
</html>