<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>질문 - 코드블루</title>

<!-- Custom fonts for this template-->
<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet"
	type="text/css">
<link
	href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
	rel="stylesheet">

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote-lite.css"
	rel="stylesheet">
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.12/summernote-lite.js"></script>

<!-- Custom styles for this template-->
<link href="css/sb-admin-2.min.css" rel="stylesheet">
<!-- Custom styles for codeBlue -->
<link href="css/codeBlue.css" rel="stylesheet">
</head>

<body id="page-top">

	<!-- Topbar -->
	<div id="topBar"></div>
	<!-- End of Topbar -->

	<div class='content'>
		<!-- Begin Page Content -->
		<div class="container">
			<div class="row">
				<!-- Side Bar -->
				<div class="col-sm-1 p-0 " style="border-right: 1px solid #d9d9d9;">
					<nav class="navbar pl-0 sticky-container">
						<div style="margin-top: 70px">
							<ul class="nav flex-column">
								<li class="pl-0"><small>질문</small></li>
								<li class="nav-item pl-1"><a
									class="nav-link pl-2 font-weight-bold pt-1 pb-0" href="/">today</a></li>
								<li class="nav-item pl-1"><a
									class="nav-link pl-2 text-danger font-weight-bold pt-1 pb-0"
									href="/">hot 🔥</a></li>
								<li class="nav-item pl-1"><a
									class="nav-link pl-2 text-warning font-weight-bold pt-1 pb-0"
									href="/">help!</a></li>
								<li class="nav-item pl-1"><a
									class="nav-link pl-2 text-success font-weight-bold pt-1 pb-0"
									href="/">ongoing</a></li>
								<li class="mt-2"><small>조회</small></li>
								<li class="nav-item"><a
									class="nav-link text-dark pl-2 pt-1 pb-0" href="/">유저</a></li>
								<li class="nav-item"><a
									class="nav-link text-dark pl-2 pt-1 pb-0" href="/">태그</a></li>
								<li class="nav-item"><a
									class="nav-link text-dark pl-2 pt-1 pb-0" href="/">랭킹</a></li>
							</ul>
						</div>
					</nav>
				</div>
				<!-- Side Bar End -->

				<!-- Page Content -->
				<div class="col-sm-11 pl-4">
					<!-- Page Heading -->
					<div class="d-sm-flex align-items-center justify-content-between"
						style="margin-top: 80px">
						<h4 class="text-gray-800" id="title"></h4>
					</div>
					<!-- page Heading End -->
					<small id="datetime">등록일 </small>
					<hr>
					<div class="row">
						<div class='col-sm-9'>
							<div id="tableBody" class='text-dark'></div>
							<div class="text-right mt-4">
								<a id="commentBtn"><i class='far fa-comment-dots mx-1'></i></a>
								<a id="reportBtn" class='mx-2 text-danger'>신고</a>
							</div>

							<div style="display: none;" id="questionComment">
								<form method="post">
									<div>
										<textarea class="form-control form-control-sm"
											maxlength="1000"
											placeholder="개인정보를 공유 및 요청하거나, 명예 훼손, 무단 광고, 불법 정보 유포시 모니터링 후 삭제될 수 있으며, 이에 대한 민형사상 책임은 게시자에게 있습니다."></textarea>
									</div>
									<div>
										<div class="text-right m-1">
											<button type="button" id="commentAdd"
												class="btn btn-sm btn-primary text-right px-3">등록</button>
										</div>
									</div>
								</form>
								<table id="questionCommentList">
								</table>
							</div>
							<hr>
							<!-- 덧글 입력란 -->
							<label for='summernote' class='text-dark'>도움을 줄 수 있는 사람을
								알고 계신가요? 질문에 링크를 공유해주세요!</label>
							<div id="summernote" class="mb-3"></div>
							<button class='btn btn-sm btn-primary m-1 px-4' id="addAnswerBtn">답변게시</button>
								<div class="container" style="height: 100%" align="center">
									<div class="pt-4 mt-5 text-left card shadow p-3 mx-5"> 
									<div id="answerList"  class='table table-hover text-center m-4'>

										
									</div>
											
									</div>
								</div>
							
							
							<!-- questionId 값 숨기기 -->
							<input type="text" id="questionId" hidden="hidden">

							<table id="bodyTable"></table>
						</div>

						<!-- Page rigth side bar -->
						<div class="col-sm-3 mb-4" id="rightSideBar"></div>
						<!-- rigth side bar end -->


					</div>

				</div>
			</div>
		</div>

		<!-- Footer -->
		<div id="footer"></div>
		<!-- End of Footer -->

	</div>


	<!-- Bootstrap core JavaScript-->
	<script src="vendor/jquery/jquery.min.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

	<!-- Core plugin JavaScript-->
	<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

	<!-- Custom scripts for all pages-->
	<script src="js/sb-admin-2.min.js"></script>

	<!-- summer note scripts -->
	<script src="js/summernote/summernote-bs4.min.js"></script>
	<script src="js/summernote/summernote-ko-KR.js"></script>
	<script src="js/summernote/summernote.min.js"></script>

	<!-- CodeBlue scripts -->
	<script src="js/codeBlueUser.js"></script>

</body>
<script>
	
	$('#summernote').summernote({
		  toolbar: [
				['style', ['style']],
				['style', ['bold', 'italic', 'underline', 'clear']],
				['font', ['strikethrough', 'superscript', 'subscript']],
				['fontsize', ['fontsize']],
				['color', ['color']],
				['para', ['ul', 'ol', 'paragraph']],
				['height', ['height']],
				['fontsize', ['8','10','10','10','10']],
				['para', ['ul', 'ol', 'paragraph']],
				['table', ['table']],
				['insert', ['link', 'picture', 'video']]
			],
		lang : 'ko-KR',
		placeholder: '내용을 입력해주세요',
		tabsize: 4,
		height: 150
	});
		
	
	
	
	$("#questionId").val(getParam("questionId"));
	//질문 답변 리스트 출력
	$.ajax({
		url : "/rest/getAnswerList",
		method : "post",
		data : {"questionId" : $("#questionId").val()},
		success : function(json){
			$("#answerList").empty();
			console.log("AnswerListTest : ",json)
			$(json).each(function(index, item){
				let answerhtml  = "<div>"+item.user.userId+"님의 답변</div>";
					answerhtml += "<input type='text' id='answerId' hidden='hidden' value='";
					answerhtml += item.answerId+"'>";
					answerhtml += "<div>답변 내용 "+item.answerContent+"</div>";
					answerhtml += "<div>작성날짜 : "+item.answerDatetime+"</div>";
					answerhtml += "<div><hr class='one'></div>";
					
					//버튼 생성
				 	answerhtml += "<div><a id='answerCommentBtn'><i class='far fa-comment-dots mx-1'></i></a></div>";
					answerhtml += "<div style='display: none;' id='answerComment'><div id='answerCommentList'>";
					answerhtml += "</div></div>";
					
					answerhtml += "<div><hr class='one'></div>";
					$("#answerList").append(answerhtml);
			})
		}	
	});
	
	// 질문 답변의 댓글 리스트 출력
	  $(document).on("click",'#answerCommentBtn', function(){
		/* if($("#answerComment").css("display") == "none"){   
	        jQuery('#answerComment').css("display", "block");   
	    } else {  
	        jQuery('#answerComment').css("display", "none");   
	    } */
		console.log("answerId : ", $("#answerId").val());
		$.ajax({
			url : "/rest/getAnswerCommentList",
			method : "post",
			data : {"answerId" : $("#answerId").val()},
			success :function(json){
				$("#answerCommentHtml").empty();
				console.log("answerComment",json);
				$(json).each(function(index, item){
					let answerCommentHtml  = "<div>"+item.user.userId+"</div>";
						answerCommentHtml += "<div>"+item.answerCommentContent+"</div>";
						answerCommentHtml += "<div>"+item.answerCommentDatetime+"</div>";
					$(document).on('event', '#answerCommentList', function() {
						$("#answerCommentList").append(answerCommentHtml);
					})
				})
			}
		});  
	  });  
	//질문 댓글출력
	$("#commentBtn").click(function(){
		if($("#questionComment").css("display") == "none"){   
	        jQuery('#questionComment').css("display", "block");   
	    } else {  
	        jQuery('#questionComment').css("display", "none");   
	    }  
		$("#questionCommentList").empty();
		$.ajax({
			url:"/rest/getQuestionCommentList",
			method:"POST",
			data:{"questionId" : $("#questionId").val()},
			success: function(json){
				console.log(json);
				$(json).each(function(index,item){
					html =  "<tr>"+
							"<td>"+item.user.userId+"</td>"+
							"<td>"+item.questionCommentContent+"</td>"+
							"<td>"+item.questionCommentDatetime+"</td>"+
							"</tr>";
					$("#questionCommentList").append(html);
				})
			}
		
		});
	});
	//질문 상세 정보 가져오기
	$.ajax({
		url : "/rest/questionBoardOne",
		method : "post",
		data : {"questionId" : $("#questionId").val()},
		success: function(json) {
			console.log(json);
			$("#title").append(json.questionTitle);
			$("#datetime").append(json.questionDatetime);
			$("#commentBtn").append(json.commentCount);
			$("#tableBody").append(json.questionContent);
			
		}
	});
	
// 질문 답변 추가하기
$("#addAnswerBtn").click(function(){
	console.log($("#summernote").summernote('code'));
	//alert("준비중입니다.")

	$.ajax({
		url : "/rest/answerAdd",
		method : "post",
		data : {"questionBoard.questionId" : $("#questionId").val(),
				"answerContent" : $("#summernote").summernote('code')},
		success : function(json){
			console.log(json)
			$.ajax({
				url : "/rest/getAnswerList",
				method : "post",
				data : {"questionId" : $("#questionId").val()},
				success : function(json){
					$("#answerList").empty();
					console.log("AnswerListTest : ",json)
					$(json).each(function(index, item){
						let answerhtml  = "<div>"+item.user.userId+"님의 답변</div>";
						answerhtml += "<input type='text' id='answerId' hidden='hidden' value='";
						answerhtml += item.answerId+"'>";
						answerhtml += "<div>답변 내용 "+item.answerContent+"</div>";
						answerhtml += "<div>작성날짜 : "+item.answerDatetime+"</div>";
						answerhtml += "<div><hr class='one'></div>";
						
						//버튼 생성
					 	answerhtml += "<div><a id='answerCommentBtn'><i class='far fa-comment-dots mx-1'></i></a></div>";
						answerhtml += "<div style='display: none;' id='answerComment'><div id='answerCommentList'>";
						answerhtml += "</div></div>";
						
						answerhtml += "<div><hr class='one'></div>";
						$("#answerList").append(answerhtml);
					})
				}	
			});
		}	
	})
});
</script>


</html>
